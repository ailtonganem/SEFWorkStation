// js/manualCompartilhamento.js - Conte√∫do do Manual do Usu√°rio para o M√≥dulo de Compartilhamento
// v1.3 - Reescreve se√ß√£o de configura√ß√£o para ser um passo a passo mais claro e detalhado, prevenindo erros.
// v1.2 - Detalha o passo a passo para configura√ß√£o da pasta compartilhada.
// v1.1 - Adiciona subse√ß√£o sobre Hist√≥rico de Envios.
// v1.0 - Conte√∫do detalhado para a funcionalidade de compartilhamento.

window.SEFWorkStation = window.SEFWorkStation || {};
window.SEFWorkStation.ManualConteudo = window.SEFWorkStation.ManualConteudo || {};

window.SEFWorkStation.ManualConteudo.Compartilhamento = {
    idSecaoDOM: "manual-modulo-compartilhamento",
    tituloSecaoDisplay: "12. Compartilhamento entre Usu√°rios",
    anchorText: "M√≥dulo Compartilhamento",
    subsecoes: [
        {
            idSubSecaoDOM: "comp-visao-geral",
            tituloSubsecaoDisplay: "12.1. Vis√£o Geral do Sistema de Compartilhamento",
            conteudoMarkdown: `
O sistema de compartilhamento do SEFWorkStation permite que voc√™ envie c√≥pias de itens (como Documentos, Tarefas, etc.) para outros usu√°rios da aplica√ß√£o de forma segura e offline, utilizando uma pasta sincronizada por um servi√ßo de nuvem como o OneDrive.

**Como Funciona:**
O processo √© desenhado para ser robusto e n√£o depender de um servidor central, mantendo a filosofia offline da aplica√ß√£o.

1.  **Pasta Compartilhada:** Ambos os usu√°rios (remetente e destinat√°rio) devem ter acesso a uma mesma pasta compartilhada no sistema de arquivos, idealmente sincronizada por um servi√ßo como o OneDrive. O nome padr√£o esperado para esta pasta √© \`SEFWorkStation_Compartilhado\`.
2.  **Envio (Remetente):**
    *   O remetente seleciona um item no SEFWorkStation (ex: um documento) e clica em "Compartilhar".
    *   Ele escolhe um ou mais destinat√°rios (outros servidores cadastrados no sistema).
    *   O SEFWorkStation cria dois arquivos na pasta compartilhada: um arquivo \`.sefshare.zip\` (contendo os dados e anexos) e um arquivo \`.meta\` (com informa√ß√µes sobre quem enviou para quem).
    *   O sistema ent√£o abre o compositor de e-mail para que o remetente possa enviar uma notifica√ß√£o ao destinat√°rio.
3.  **Recebimento (Destinat√°rio):**
    *   Ap√≥s a notifica√ß√£o e a sincroniza√ß√£o da pasta, o destinat√°rio acessa a **Central de Importa√ß√£o** no seu SEFWorkStation.
    *   Ele pode selecionar o pacote \`.sefshare.zip\` recebido e o sistema mostrar√° os itens para importa√ß√£o.
    *   O destinat√°rio pode ent√£o importar uma c√≥pia daquele item para a sua pr√≥pria base de dados local.

**Importante:** O sistema compartilha uma **c√≥pia** do item. As altera√ß√µes feitas pelo destinat√°rio no item importado **n√£o** ser√£o refletidas no item original do remetente, e vice-versa. √â um sistema de envio de informa√ß√µes, n√£o de edi√ß√£o colaborativa em tempo real.
`
        },
        {
            idSubSecaoDOM: "comp-configuracao",
            tituloSubsecaoDisplay: "12.2. Configura√ß√£o Inicial (Obrigat√≥ria)",
            conteudoMarkdown: `
Para usar a funcionalidade de compartilhamento, cada usu√°rio precisa realizar duas configura√ß√µes simples, mas essenciais. Siga este passo a passo detalhado.

#### Passo 1: Criar e Compartilhar a Pasta no seu Computador (Exemplo usando OneDrive)

Esta etapa √© feita **fora** do SEFWorkStation, no seu explorador de arquivos (Windows Explorer, Finder, etc.).

1.  **Crie a Pasta:**
    *   Navegue at√© o diret√≥rio principal do seu OneDrive no seu computador (a pasta que sincroniza com a nuvem).
    *   Dentro dela, crie uma nova pasta com o nome **exato**: \`SEFWorkStation_Compartilhado\`.
2.  **Compartilhe a Pasta com seus Colegas:**
    *   Clique com o bot√£o direito do mouse sobre a nova pasta \`SEFWorkStation_Compartilhado\`.
    *   No menu que aparece, procure pela op√ß√£o "Compartilhar" (geralmente com um √≠cone do OneDrive).
    *   Uma janela de compartilhamento do OneDrive se abrir√°.
    *   Digite os e-mails dos colegas com quem voc√™ deseja compartilhar itens.
    *   **Crucial:** Certifique-se de que a permiss√£o esteja definida como **"Pode editar"** ou **"Edi√ß√£o"**. Isso √© necess√°rio para que o SEFWorkStation dos seus colegas possa atualizar o status dos arquivos de compartilhamento quando eles importarem um item.
    *   Envie o convite.
3.  **Para quem recebe o convite:**
    *   Seus colegas receber√£o um e-mail com um link para acessar a pasta. Eles devem clicar e seguir as instru√ß√µes para adicionar a pasta compartilhada ao OneDrive deles.
    *   √â fundamental que eles garantam que a pasta \`SEFWorkStation_Compartilhado\` apare√ßa no explorador de arquivos deles e esteja sendo sincronizada pelo cliente OneDrive.

#### Passo 2: Configurar o SEFWorkStation (Todos os usu√°rios devem fazer)

Agora, dentro da aplica√ß√£o SEFWorkStation:

1.  **Defina sua Identidade de Usu√°rio:**
    *   No menu superior, v√° para **Configura√ß√µes**.
    *   Na se√ß√£o "Identidade e Compartilhamento", localize o campo "**Usu√°rio Atual da Aplica√ß√£o**".
    *   Selecione **seu pr√≥prio nome** na lista de servidores cadastrados. Se seu nome n√£o estiver na lista, voc√™ precisa primeiro se cadastrar como um servidor no **M√≥dulo de Servidores**.
    *   **Esta etapa √© obrigat√≥ria.** Sem ela, o sistema n√£o saber√° quem voc√™ √© para enviar ou receber itens.
2.  **Selecione a Pasta Compartilhada no Sistema:**
    *   Ainda na mesma se√ß√£o de "Identidade e Compartilhamento", clique no bot√£o **"Selecionar"** ao lado de "Pasta Compartilhada (OneDrive)".
    *   Uma janela do seu sistema de arquivos ser√° aberta.
    *   Navegue at√© a pasta \`SEFWorkStation_Compartilhado\` que voc√™ criou e configurou no Passo 1.
    *   Clique em "Selecionar pasta".
    *   O navegador solicitar√° sua permiss√£o para que o SEFWorkStation possa ler e escrever nesta pasta. **Voc√™ deve conceder essa permiss√£o.**
    *   O nome da pasta aparecer√° no campo de texto, confirmando a sele√ß√£o para a sess√£o atual.
3.  **Salve as Prefer√™ncias:**
    *   Role at√© o final da p√°gina de Configura√ß√µes e clique no bot√£o grande "**Salvar Todas as Prefer√™ncias**". Isso salvar√° sua identidade de usu√°rio. A refer√™ncia √† pasta compartilhada √© geralmente mantida por sess√£o e ser√° solicitada novamente se necess√°rio.

Com estes passos conclu√≠dos, voc√™ e sua equipe est√£o prontos para trocar informa√ß√µes atrav√©s do SEFWorkStation.
`
        },
        {
            idSubSecaoDOM: "comp-enviando",
            tituloSubsecaoDisplay: "12.3. Como Compartilhar um Item",
            conteudoMarkdown: `
Depois de configurar seu usu√°rio e a pasta, compartilhar um item √© simples.

1.  **Localize o Item:** Navegue at√© o item que deseja compartilhar (ex: visualize um Documento em "Gerir Documentos").
2.  **Clique em Compartilhar:** Na tela de visualiza√ß√£o do item, procure e clique no bot√£o "**Compartilhar**" (geralmente com um √≠cone de compartilhamento üîó ou üì§).
3.  **Selecione os Destinat√°rios:**
    *   Uma janela (modal) aparecer√°, permitindo que voc√™ escolha para quem deseja enviar.
    *   Comece a digitar o nome de um **Servidor** ou **Grupo de Servidores** cadastrado no sistema.
    *   Uma lista de sugest√µes aparecer√°. Clique nos nomes para adicion√°-los √† lista de destinat√°rios.
    *   Voc√™ pode adicionar m√∫ltiplos servidores e/ou grupos.
4.  **Confirme o Compartilhamento:**
    *   Clique no bot√£o "**Compartilhar e Notificar**" (ou similar).
    *   O sistema far√° o seguinte em segundo plano:
        *   Criar√° o arquivo \`.sefshare.zip\` contendo os dados do item e, opcionalmente, seus anexos.
        *   Salvar√° um registro deste envio no seu Hist√≥rico local.
        *   Abrir√° o **Compositor de E-mail** com uma mensagem padr√£o, j√° endere√ßada aos e-mails dos servidores e membros dos grupos que voc√™ selecionou.
5.  **Envie a Notifica√ß√£o:**
    *   Revise o e-mail pr√©-preenchido e clique em "**Gerar E-mail (.eml)**".
    *   Abra o arquivo \`.eml\` salvo em seu cliente de e-mail e envie-o para que seus colegas saibam que h√° um novo item para eles. O arquivo .sefshare.zip **n√£o √© anexado automaticamente**, voc√™ deve envi√°-lo por outros meios ou garantir que o destinat√°rio tenha acesso √† pasta sincronizada.
`
        },
        {
            idSubSecaoDOM: "comp-recebendo-importando",
            tituloSubsecaoDisplay: "12.4. Recebendo e Importando Itens",
            conteudoMarkdown: `
Quando um colega compartilha um item com voc√™, o processo de recebimento √© o seguinte:

1.  **Receba o Pacote:** Voc√™ receber√° um arquivo com a extens√£o \`.sefshare.zip\` enviado pelo seu colega (seja por e-mail ou outro meio). Salve este arquivo em seu computador.
2.  **Acesse a Central de Importa√ß√£o:** No SEFWorkStation, navegue at√© **Compartilhamento > Itens Recebidos**.
3.  **Selecione o Arquivo:**
    *   Clique no bot√£o "**Selecionar Arquivo de Compartilhamento**".
    *   Na janela que se abre, localize e selecione o arquivo \`.sefshare.zip\` que voc√™ recebeu.
4.  **Tela de Revis√£o:**
    *   Ap√≥s a sele√ß√£o, o sistema analisar√° o pacote e exibir√° uma tela de revis√£o com os itens contidos nele.
    *   **Resolu√ß√£o de Conflitos:** Se um item do pacote tiver o **mesmo ID interno** de um item j√° existente na sua base de dados, o sistema marcar√° como um "Conflito" e apresentar√° op√ß√µes:
        *   **Sobrescrever item local:** A sua vers√£o local do item ser√° substitu√≠da pela vers√£o que voc√™ est√° importando. **Use com cuidado.**
        *   **Ignorar este item:** A importa√ß√£o daquele item espec√≠fico √© cancelada, mantendo sua vers√£o local intacta.
    *   Para itens novos (sem conflito), voc√™ pode simplesmente optar por import√°-los ou ignor√°-los.
5.  **Importe os Itens:**
    *   Ap√≥s revisar e selecionar as a√ß√µes para cada item, clique no bot√£o "**Confirmar e Importar Itens Selecionados**".
    *   O sistema processar√° a importa√ß√£o.
6.  **Confirma√ß√£o:**
    *   Uma mensagem de sucesso ser√° exibida.
    *   Os itens importados agora est√£o dispon√≠veis em seus respectivos m√≥dulos (ex: um documento importado aparecer√° em "Gerir Documentos").
`
        },
        {
            idSubSecaoDOM: "comp-historico",
            tituloSubsecaoDisplay: "12.5. Central de Compartilhamento e Hist√≥rico de Envios",
            conteudoMarkdown: `
A Central de Compartilhamento permite que voc√™ gerencie o processo de envio em lote e rastreie todos os itens que voc√™ compartilhou com outros usu√°rios.

**Acesso:**
*   Navegue at√© **Compartilhamento > Central de Compartilhamento**.

**Aba "Compartilhar em Lote":**
*   Esta aba permite que voc√™ selecione m√∫ltiplos itens de um mesmo tipo (ex: v√°rios documentos) e os compartilhe de uma s√≥ vez para um grupo de destinat√°rios, gerando um √∫nico pacote \`.sefshare.zip\` e uma √∫nica notifica√ß√£o por e-mail.

**Aba "Hist√≥rico de Envios":**
*   **Listagem de Envios:** A tela exibe uma tabela com todos os seus envios, ordenados do mais recente para o mais antigo.
*   **A√ß√µes na Lista de Hist√≥rico:**
    *   **Visualizar Detalhes (clicando no t√≠tulo):** Leva para uma nova p√°gina com todos os detalhes do pacote compartilhado, incluindo os itens enviados e o status de importa√ß√£o de cada destinat√°rio.
    *   **Revogar Compartilhamento (üîó):** Esta a√ß√£o tenta apagar os arquivos (\`.meta\` e \`.sefshare.zip\`) da pasta compartilhada, impedindo futuras importa√ß√µes por destinat√°rios que ainda n√£o o fizeram.
    *   **Excluir Registro de Envio (üóëÔ∏è):** Remove o registro do seu hist√≥rico local e tamb√©m tenta apagar os arquivos da pasta compartilhada.
*   **Rastreamento de Importa√ß√£o:** Na tela de detalhes do envio, voc√™ pode ver o status de importa√ß√£o para cada destinat√°rio. Este status √© atualizado quando um destinat√°rio importa o item e seu servi√ßo de nuvem sincroniza o arquivo \`.meta\` atualizado de volta para a sua pasta.
`
        }
    ]
};